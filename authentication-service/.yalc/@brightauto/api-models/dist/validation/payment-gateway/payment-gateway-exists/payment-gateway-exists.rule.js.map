{"version":3,"sources":["../../../../src/validation/payment-gateway/payment-gateway-exists/payment-gateway-exists.rule.ts"],"sourcesContent":["import { Injectable } from \"@nestjs/common\";\nimport { ValidationArguments, ValidatorConstraint, ValidatorConstraintInterface } from \"class-validator\";\nimport { DataSource, ILike } from \"typeorm\";\n\n@ValidatorConstraint({ name: 'RelationExists', async: true })\n@Injectable()\nexport class PaymentGatewayExistsRule implements ValidatorConstraintInterface {\n  constructor(private dataSource: DataSource) {}\n\n  async validate(value: any, args: ValidationArguments) {\n    try {\n      const [model] = args.constraints;\n      const input = (args.object as any);\n      const name: string = input['name'];\n      let query = {};\n      query['name'] = ILike(name);\n\n      // console.log(typeof value);\n      await this.dataSource.getRepository(model).findOneByOrFail(query);\n    } catch (e) {\n      // console.log(e)\n      return false;\n    }\n\n    return true;\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return `The selected payment gateway is not exists!`;\n  }\n}"],"names":["PaymentGatewayExistsRule","validate","value","args","model","constraints","input","object","name","query","ILike","dataSource","getRepository","findOneByOrFail","e","defaultMessage","constructor","ValidatorConstraint","async","Injectable"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAMaA;;;eAAAA;;;wBANc;gCAC4D;yBACrD;;;;;;;;;;AAI3B,IAAA,AAAMA,2BAAN,MAAMA;IAGX,MAAMC,SAASC,KAAU,EAAEC,IAAyB,EAAE;QACpD,IAAI;YACF,MAAM,CAACC,MAAM,GAAGD,KAAKE,WAAW;YAChC,MAAMC,QAASH,KAAKI,MAAM;YAC1B,MAAMC,OAAeF,KAAK,CAAC,OAAO;YAClC,IAAIG,QAAQ,CAAC;YACbA,KAAK,CAAC,OAAO,GAAGC,IAAAA,cAAK,EAACF;YAEtB,6BAA6B;YAC7B,MAAM,IAAI,CAACG,UAAU,CAACC,aAAa,CAACR,OAAOS,eAAe,CAACJ;QAC7D,EAAE,OAAOK,GAAG;YACV,iBAAiB;YACjB,OAAO;QACT;QAEA,OAAO;IACT;IAEAC,eAAeZ,IAAyB,EAAE;QACxC,OAAO,CAAC,2CAA2C,CAAC;IACtD;IAtBAa,YAAY,AAAQL,UAAsB,CAAE;aAAxBA,aAAAA;IAAyB;AAuB/C;AAxBaX;IAFZiB,IAAAA,mCAAmB,EAAC;QAAET,MAAM;QAAkBU,OAAO;IAAK;IAC1DC,IAAAA,kBAAU;;;eAEuB,mBAAU,4BAAV,mBAAU;;GAD/BnB"}